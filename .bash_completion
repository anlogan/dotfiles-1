#!/bin/bash

# git-commit override
_git_commit () {
  local cur prev ng_set

  # do nothing if we're not in a repo
  git rev-parse 2>/dev/null || return 0

  COMPREPLY=()
  cur=${COMP_WORDS[COMP_CWORD]}
  prev=${COMP_WORDS[COMP_CWORD-1]}

  # complete uncommitted files
  if [[ ${COMP_WORDS[1]} = "commit" ]]; then
    COMPREPLY=( $(compgen -W "\
                $( while read file; do
                     echo ${file:2}
                   done < <(git status -s) )" -- $cur ) )
  fi
}

# powerpill
complete -o filenames -F _pacman spp pp

# go
complete -f -X '!*.8' 8l
complete -f -X '!*.6' 6l
complete -f -X '!*.5' 5l
complete -f -X '!*.go' 8g 6g 5g gofmt gccgo
